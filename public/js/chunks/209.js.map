{"version":3,"sources":["webpack:///resources/js/src/views/pages/drivers/components/FilesTab.vue","webpack:///./resources/js/src/views/pages/drivers/components/FilesTab.vue","webpack:///./resources/js/src/views/pages/drivers/components/FilesTab.vue?0a0f","webpack:///./resources/js/src/views/pages/drivers/components/FilesTab.vue?a042","webpack:///./resources/js/src/views/pages/drivers/components/FilesTab.vue?acd4"],"names":["render","_vm","_c","_self","attrs","dataArray","files","showFileUploadIcon","imagePreview","isEditMode","showDownload","on","addFolder","deleteFile","uploadFiles","fileDragStart","fileDropEnd","staticRenderFns","_withStripped"],"mappings":"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","file":"js/chunks/209.js","sourcesContent":["<template>\r\n  <div>\r\n    <Folders\r\n      :dataArray=\"files\"\r\n      :showFileUploadIcon=\"true\"\r\n      :imagePreview=\"isEditMode\"\r\n      :showDownload=\"isEditMode\"\r\n      @addFolder=\"addFolder\"\r\n      @deleteFile=\"deleteFile\"\r\n      @uploadFiles=\"uploadFiles\"\r\n      @fileDragStart=\"fileDragStart\"\r\n      @fileDropEnd=\"fileDropEnd\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<!-- eslint-disable multiline-ternary nonblock-statement-body-position -->\r\n<script>\r\nimport { mapGetters } from 'vuex'\r\n\r\nexport default {\r\n  name: 'FilesTab',\r\n  components: {\r\n    Folders: () => import('@/components/folders/Folders')\r\n  },\r\n  data() {\r\n    return {\r\n      dragStartFile: null,\r\n    };\r\n  },\r\n  props: {\r\n    dataObj: {\r\n      type: Object,\r\n      default: () => ({})\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapGetters('driverV2', [\r\n      'getFileList',\r\n      'getFolderList',\r\n      'getSelectedDriver'\r\n    ]),\r\n\r\n    files () {\r\n      return this.getFolderList.map((folder) => {\r\n        let files = []\r\n        if (this.isEditMode)\r\n          files = this.getFileList.filter(\r\n            (file) => file.folderId === folder.id\r\n          )\r\n        else if (\r\n          this.dataObj &&\r\n          this.dataObj.files &&\r\n          this.dataObj.files.length > 0\r\n        )\r\n          files = this.dataObj.files.filter(\r\n            (file) => file.folderId === folder.id\r\n          )\r\n\r\n        return {\r\n          ...folder,\r\n          files\r\n        }\r\n      })\r\n    },\r\n    isEditMode () {\r\n      return this.$route.name === 'drivers-edit'\r\n    },\r\n    driverId () {\r\n      return this.$route.params.id\r\n    }\r\n  },\r\n  created () {\r\n    this.init()\r\n  },\r\n  methods: {\r\n    fileDragStart(file) {\r\n      this.dragStartFile = [file];\r\n    },\r\n    fileDropEnd(file) {\r\n      if (this.isEditMode) {\r\n        const getFileId = this.dragStartFile.map((item) => {\r\n          return { fileId: item.id };\r\n        });\r\n        const payload = {\r\n          folderId: file.folderId,\r\n          files: getFileId,\r\n        };\r\n        this.$store.dispatch('driverV2/driverFileChangeFolder', payload);\r\n        this.fetchFiles();\r\n      }\r\n    },\r\n    fetchFolders () {\r\n      return this.$store.dispatch('driverV2/fetchFolderList')\r\n    },\r\n    fetchFiles () {\r\n      return this.$store.dispatch('driverV2/fetchFiles', this.driverId)\r\n    },\r\n    getErrorMsg (error) {\r\n      return error &&\r\n        error.response &&\r\n        error.response.data &&\r\n        error.response.data.message\r\n        ? error.response.data.message\r\n        : 'Something went wrong'\r\n    },\r\n    async init () {\r\n      try {\r\n        if (this.getFolderList.length === 0 || this.isEditMode)\r\n          this.$vs.loading()\r\n\r\n        if (this.getFolderList.length === 0) await this.fetchFolders()\r\n        if (this.isEditMode) await this.fetchFiles()\r\n      } catch (error) {\r\n        this.$vs.notify({\r\n          time: 8000,\r\n          color: 'danger',\r\n          title: 'Error',\r\n          text: this.getErrorMsg(error)\r\n        })\r\n      } finally {\r\n        this.$vs.loading.close()\r\n      }\r\n    },\r\n    async addFolder ({ isEdit, id, folderName }) {\r\n      try {\r\n        isEdit\r\n          ? await this.$store.dispatch('driverV2/updateFolder', {\r\n            folderId: id,\r\n            folderName\r\n          })\r\n          : await this.$store.dispatch('driverV2/createFolder', {\r\n            folderName\r\n          })\r\n        await this.fetchFolders()\r\n      } catch (error) {\r\n        await this.$vs.notify({\r\n          time: 8000,\r\n          color: 'danger',\r\n          title: 'Error',\r\n          text: error.response.data.message || error.message\r\n        })\r\n      }\r\n    },\r\n    async deleteFile ({ file: { id }, index }) {\r\n      try {\r\n        if (!this.isEditMode) {\r\n          const payload = {\r\n            files: this.dataObj.files.filter((file, i) => i !== index)\r\n          }\r\n          this.$emit('update:Files', payload)\r\n          return\r\n        }\r\n\r\n        await this.$store.dispatch('driverV2/deleteFile', id)\r\n        await this.fetchFiles()\r\n\r\n        this.$vs.notify({\r\n          time: 2000,\r\n          color: 'success',\r\n          title: 'File Deleted',\r\n          text: 'File deleted successfully'\r\n        })\r\n      } catch (error) {\r\n        this.$vs.notify({\r\n          time: 8000,\r\n          color: 'danger',\r\n          title: 'Error',\r\n          text: this.getErrorMsg(error)\r\n        })\r\n      }\r\n    },\r\n    getFileExtension (files) {\r\n      const fileExtension = files.map((file) => {\r\n        const extension = file.name.split('.').pop()\r\n        return { extension }\r\n      })\r\n\r\n      return fileExtension\r\n    },\r\n    async generateS3NameAndURL (files) {\r\n      try {\r\n        if (files.length === 0) return\r\n\r\n        const allFiles = await this.getFileExtension(files)\r\n        const {\r\n          data: { result, payload }\r\n        } = await this.$store.dispatch('driverV2/uploadAttachment', {\r\n          files: allFiles\r\n        })\r\n\r\n        return result && payload ? payload : []\r\n      } catch (error) {}\r\n    },\r\n    async uploadAttachmentsToS3 (s3FileNameAndURL, files) {\r\n      this.$vs.loading()\r\n      try {\r\n        if (s3FileNameAndURL) {\r\n          const attachments = []\r\n\r\n          for (let i = 0; i < s3FileNameAndURL.length; i++) {\r\n            const { fileName, url } = s3FileNameAndURL[i]\r\n            const file = files[i]\r\n\r\n            const { status } = await this.$store.dispatch('uploadFileToS3ViaPresignedUrl', {\r\n              url,\r\n              file,\r\n              extension: fileName.split(\".\").pop()\r\n            })\r\n\r\n            if (status === 200)\r\n              attachments.push({\r\n                fileName,\r\n                originalFileName: file.name\r\n              })\r\n          }\r\n\r\n          return attachments\r\n        }\r\n      } catch (error) {\r\n      } finally {\r\n        this.$vs.loading.close()\r\n      }\r\n    },\r\n    async uploadFiles ({ folderId, files }) {\r\n      try {\r\n        // Process attachments\r\n        const s3FileNameAndURL = await this.generateS3NameAndURL(files)\r\n        const attachments =\r\n          (await this.uploadAttachmentsToS3(s3FileNameAndURL, files)) || []\r\n\r\n        if (this.isEditMode) {\r\n          const payload = {\r\n            folderId,\r\n            userId: parseInt(this.driverId),\r\n            files: attachments\r\n          }\r\n          await this.$store.dispatch('driverV2/uploadFiles', payload)\r\n          await this.fetchFiles()\r\n        } else {\r\n          const payload = attachments.map((file, index) => ({\r\n            ...file,\r\n            url: s3FileNameAndURL[index].url,\r\n            folderId\r\n          }))\r\n\r\n          const files = this.dataObj.files\r\n            ? [...this.dataObj.files, ...payload]\r\n            : [...payload]\r\n\r\n          this.$emit('update:Files', {\r\n            files\r\n          })\r\n        }\r\n      } catch (error) {\r\n        this.$vs.notify({\r\n          time: 8000,\r\n          color: 'danger',\r\n          title: 'Error',\r\n          text: this.getErrorMsg(error)\r\n        })\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n","var render = function render() {\n  var _vm = this,\n    _c = _vm._self._c\n  return _c(\n    \"div\",\n    [\n      _c(\"Folders\", {\n        attrs: {\n          dataArray: _vm.files,\n          showFileUploadIcon: true,\n          imagePreview: _vm.isEditMode,\n          showDownload: _vm.isEditMode,\n        },\n        on: {\n          addFolder: _vm.addFolder,\n          deleteFile: _vm.deleteFile,\n          uploadFiles: _vm.uploadFiles,\n          fileDragStart: _vm.fileDragStart,\n          fileDropEnd: _vm.fileDropEnd,\n        },\n      }),\n    ],\n    1\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./FilesTab.vue?vue&type=template&id=27406f24&\"\nimport script from \"./FilesTab.vue?vue&type=script&lang=js&\"\nexport * from \"./FilesTab.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"D:\\\\laragon\\\\www\\\\ezpapel\\\\panel\\\\node_modules\\\\vue-hot-reload-api\\\\dist\\\\index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('27406f24')) {\n      api.createRecord('27406f24', component.options)\n    } else {\n      api.reload('27406f24', component.options)\n    }\n    module.hot.accept(\"./FilesTab.vue?vue&type=template&id=27406f24&\", function () {\n      api.rerender('27406f24', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"resources/js/src/views/pages/drivers/components/FilesTab.vue\"\nexport default component.exports","import mod from \"-!../../../../../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FilesTab.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FilesTab.vue?vue&type=script&lang=js&\"","export * from \"-!../../../../../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??ref--6!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FilesTab.vue?vue&type=template&id=27406f24&\""],"sourceRoot":""}